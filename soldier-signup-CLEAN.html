<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>חתימה על ציוד - פלוגה כ׳</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background: #f0f4f8; padding: 20px; display: flex; justify-content: center; }
        .card { background: white; padding: 25px; border-radius: 12px; width: 100%; max-width: 500px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-top: 6px solid #2c5f2d; }
        .form-group { margin-bottom: 15px; text-align: right; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; font-family: inherit; }
        .check-group { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 6px; }
        .check-group input { width: auto; }
        .btn { width: 100%; background: #2c5f2d; color: white; border: none; padding: 14px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;
        function SignupForm() {
            const [status, setStatus] = useState('idle');
            const [form, setForm] = useState({ name:'', id:'', unit:'מחלקה 1', role:'חייל', r624:false, lio:false, charger:false, vest:false });

            const send = async (e) => {
                e.preventDefault();
                if (form.id.toString().length !== 7) return alert('מ"א חייב להיות 7 ספרות בדיוק');
                setStatus('sending');
                const data = {
                    soldierName: form.name, soldierId: form.id, unit: form.unit, role: form.role,
                    equipment: { radio624: form.r624, lionet: form.lio, charger: form.charger, vest: form.vest },
                    date: new Date().toISOString(), id: Date.now()
                };
                await fetch('https://plugat-kaf-default-rtdb.firebaseio.com/checkouts.json', { method: 'POST', body: JSON.stringify(data) });
                setStatus('done');
            };

            if (status === 'done') return <div className="card"><h2>✓ החתימה בוצעה בהצלחה!</h2><button className="btn" onClick={() => window.location.reload()}>חתימה נוספת</button></div>;

            return (
                <div className="card">
                    <h2 style={{textAlign:'center', color:'#2c5f2d'}}>טופס חתימה פלוגתי</h2>
                    <form onSubmit={send}>
                        <div className="form-group"><label>שם מלא</label><input required onChange={e=>setForm({...form, name:e.target.value})}/></div>
                        <div className="form-group"><label>מספר אישי (7 ספרות)</label><input required type="number" onChange={e=>setForm({...form, id:e.target.value})}/></div>
                        <div className="form-group"><label>מחלקה</label><select onChange={e=>setForm({...form, unit:e.target.value})}>{['מחלקה 1','מחלקה 2','מחלקה 3','חפק','חמל','מפלג'].map(u=><option key={u}>{u}</option>)}</select></div>
                        <div className="form-group"><label>תפקיד</label><select onChange={e=>setForm({...form, role:e.target.value})}>{['חייל','מ"כ','סמל','מ"מ','סמ"פ','מ"פ','אחר'].map(r=><option key={r}>{r}</option>)}</select></div>
                        
                        <h4 style={{marginBottom:'10px', color:'#2c5f2d'}}>סמן על מה חתמת:</h4>
                        <div className="check-group"><input type="checkbox" onChange={e=>setForm({...form, r624:e.target.checked})}/> <label>קשר 624</label></div>
                        <div className="check-group"><input type="checkbox" onChange={e=>setForm({...form, lio:e.target.checked})}/> <label>ליונט</label></div>
                        <div className="check-group"><input type="checkbox" onChange={e=>setForm({...form, charger:e.target.checked})}/> <label>מטען ליונט</label></div>
                        <div className="check-group"><input type="checkbox" onChange={e=>setForm({...form, vest:e.target.checked})}/> <label>מעד</label></div>
                        
                        <button className="btn" disabled={status === 'sending'}>{status === 'sending' ? 'שומר...' : 'בצע חתימה'}</button>
                    </form>
                </div>
            );
        }
        ReactDOM.render(<SignupForm />, document.getElementById('root'));
    </script>
</body>
</html>
